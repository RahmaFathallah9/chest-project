// ####### Copyright (c) 2011, William Duffy - www.wduffy.co.uk                 #######
// ####### The above copyright notice and this permission notice shall be       #######
// ####### NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT          #######
function fitVideoToContainer(e,t){var i=t.height(),n=t.width();e.attr("style",null);var a=e.player();a.height(i),a.width(n),$("object",e).attr({width:n,height:i})}function fitImageToContainer(e,t){var i=e.attr("data-width"),n=e.attr("data-height"),a=t.width(),l=t.height();n/l>i/a?(newHeight=l,newWidth=newHeight/n*i):(newWidth=a,newHeight=newWidth/i*n),margin_top=(l-newHeight)/2,margin_left=(a-newWidth)/2,e.css({"margin-top":margin_top+"px","margin-left":margin_left+"px",height:newHeight+"px",width:newWidth+"px"})}function isVideo(e){return"VIDEO"==e.attr("tagName")}function fitImagesToContainer(e){img=e.find("li > img, li video"),img.each(function(){mediaElem=$(this),(isVideo(mediaElem)?fitVideoToContainer:fitImageToContainer)(mediaElem,e)},0)}function ensureHeight(e,t){e.height()<t&&e.height(t)}!function(e){e.fn.jScroll=function(t){function i(e,t){this.min=e.offset().top,this.originalMargin=parseInt(e.css("margin-top"),10)||0,this.getMargin=function(i){var n=this.originalMargin,a=e.parent().height()-e.outerHeight()-t;return i.scrollTop()>=this.min&&(n=n+parseInt(e.attr("top"),10)+i.scrollTop()-this.min),n>a&&(n=a),n<0&&(n=0),{marginTop:n+"px"}}}var n=e.extend({},e.fn.jScroll.defaults,t);return this.each(function(){var t=e(this),a=e(window),l=new i(t,n.contentBottomOffset);t.attr("top",n.top),a.scroll(function(){t.stop().animate(l.getMargin(a),n.speed)})})},e.fn.jScroll.defaults={speed:"slow",top:10,contentBottomOffset:0}}(jQuery),
/*!
 * Clamp.js 0.7.0
 *
 * Copyright 2011-2013, Joseph Schmitt http://joe.sh
 * Released under the WTFPL license
 * http://sam.zoy.org/wtfpl/
 */
function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.$clamp=t()}(this,function(){function e(e,t){function i(t){var i=t||e.clientHeight,n=a(e);return Math.max(Math.floor(i/n),0)}function n(t){return a(e)*t}function a(e){var t=$(e).css("line-height");return"normal"==t&&(t=1.2*parseInt($(e).css("font-size"))),parseInt(t)}function l(t){return t.lastChild.children&&t.lastChild.children.length>0?l(Array.prototype.slice.call(t.children).pop()):t.lastChild&&t.lastChild.nodeValue&&""!==t.lastChild.nodeValue&&t.lastChild.nodeValue!=c.truncationChar?t.lastChild:(t.lastChild.parentNode.removeChild(t.lastChild),l(e))}function r(t,i){function n(){v=c.splitOnChars.slice(0),b=v[0],g=null,m=null}if(i){var a=t.nodeValue.replace(c.truncationChar,"");if(g||(b=v.length>0?v.shift():"",g=a.split(b)),g.length>1?(m=g.pop(),o(t,g.join(b))):g=null,s&&(t.nodeValue=t.nodeValue.replace(c.truncationChar,""),e.innerHTML=t.nodeValue+" "+s.innerHTML+c.truncationChar),g){if(e.clientHeight<=i){if(!(v.length>=0&&""!==b))return e.innerHTML;o(t,g.join(b)+b+m),g=null}}else""===b&&(o(t,""),t=l(e),n());if(!c.animate)return r(t,i);setTimeout(function(){r(t,i)},!0===c.animate?10:c.animate)}}function o(e,t){e.nodeValue=t+c.truncationChar}t=t||{};window;var s,c={clamp:t.clamp||2,useNativeClamp:"undefined"==typeof t.useNativeClamp||t.useNativeClamp,splitOnChars:t.splitOnChars||[".","-","\u2013","\u2014"," "],animate:t.animate||!1,truncationChar:t.truncationChar||"\u2026",truncationHTML:t.truncationHTML},h=e.style,u=e.innerHTML,d="undefined"!=typeof e.style.webkitLineClamp,p=c.clamp,f=p.indexOf&&(p.indexOf("px")>-1||p.indexOf("em")>-1);c.truncationHTML&&((s=document.createElement("span")).innerHTML=c.truncationHTML);var g,m,w,v=c.splitOnChars.slice(0),b=v[0];if("auto"==p?p=i():f&&(p=i(parseInt(p))),d&&c.useNativeClamp)h.overflow="hidden",h.textOverflow="ellipsis",h.webkitBoxOrient="vertical",h.display="-webkit-box",h.webkitLineClamp=p,f&&(h.height=c.clamp+"px");else{var C=n(p);C<=e.clientHeight&&(w=r(l(e),C))}return{original:u,clamped:w}}return e});var sidebarSelector=".two-column-layout-sidebar";$(function(){function e(e){!$("#article-gallery").is(":visible")||e&&0!=$(e.target).parents(sidebarSelector).length||($("#article-sidebar-info").unblock(),$("#article-gallery").hide(),null!=l&&ensureHeight($(sidebarSelector),l))}function t(){ensureHeight($("#content"),$("#article-gallery").height()),ensureHeight($(sidebarSelector),$("#content").outerHeight())}function i(){topMargin=($(window).height()-$("#article-gallery").height())/2,topMargin<0&&(topMargin=0),$("#article-gallery").attr("top",topMargin)}function n(){$(".carousel").bind("imageChanged",function(){fitImagesToContainer($(".image.target"))}),fitImagesToContainer($(".image.target"))}var a=!1,l=null,r=$("body").data().touchBrowser;$(document).bind("click",e),$("li a.thumbnail").click(function(o){if(!o.metaKey&&!o.ctrlKey)if($(document).width()<992){var s=$(this).data().presentationPath;s!==undefined&&(o.preventDefault(),window.location=s)}else{null==l&&(l=$(sidebarSelector).height()+20),$("#article-gallery").show().css("margin-top","0px"),$("#article-sidebar-info").css("position","absolute").block({message:null,baseZ:0,overlayCSS:{cursor:"default"}}),ensureHeight($(sidebarSelector),l),$(".blockOverlay").bind("click",function(){e()}),a||r||$("#article-gallery").jScroll({contentBottomOffset:parseInt($(sidebarSelector+" .action-toolbar").outerHeight(),10)||0}),a=!0;var c=$(this),h=c.data("imageRef"),u=c.attr("data-resource-url");$(".carousel").attr("data-resource-url",u);var d=$(document.createElement("ul")).attr({"data-resource-url":u,id:"carousel","class":"carousel jcarousel-skin-radiopaedia"});$("div.jcarousel-skin-radiopaedia").replaceWith(d);var p=new OldGallery($("#article-gallery"));p.empty(),p.init(h,function(){n(),jQuery.browser.safari&&$(".carousel").jcarousel("setup"),p.clickThumb($('.carousel a[href *="'+c.data().imagePath+'?"], .carousel a[href ="'+c.data().imagePath+'"]')),t(),i(),$(window).scroll()}),t(),i(),$(window).scroll(),o.preventDefault()}}),$("#close").click(function(t){e(),t.preventDefault()}),$(window).scroll(function(e){"undefined"==typeof e.originalEvent&&e.preventDefault()}),$(".image-grid-image-caption-desc > .editable-text-on-dark").each(function(){$clamp(this,{clamp:3,useNativeClamp:!1})}),$(".js-tooltip").tooltip({sanitize:!1})}),function(){$(function(){return $(".snippet").each(function(){var e;return(e=$(this).find('a[href="'+window.location.pathname+'"], a[href="'+window.location.pathname+window.location.search+'"]')).parents("ul").parents("li").siblings().children("ul").addClass("hide_snippet").hide(),e.parents("li").siblings().children("ul").addClass("hide_snippet").hide(),e.siblings("ul").children("li").children("ul").children("li").children("ul").addClass("hide_snippet").hide(),e.contents().unwrap().wrap("<b>"),$(this).find(".hide_snippet").before('<a href="#" class="snippet_expand_toggle">[+]</a>')}),$(".snippet_expand_toggle").click(function(e){return e.preventDefault(),"[+]"===$(this).text()?($(this).text("[\u2013]"),$(this).siblings('ul[class="hide_snippet"]').show()):($(this).text("[+]"),$(this).siblings('ul[class="hide_snippet"]').hide())}),$(".snippet_hide_toggle").click(function(e){return e.preventDefault(),"hide"===$(this).text()?($(this).text("show"),$(this).siblings(".snippet_content").slideToggle()):($(this).text("hide"),$(this).siblings(".snippet_content").slideToggle())})})}.call(this),function(){var e;e=function(e){var t,i;if((t=(t=$(e)).length?t:$("[name="+e.slice(1)+"]")).length)return i=$("nav.navbar").height(),$("html, body").animate({scrollTop:t.offset().top-i},300,"swing",function(){return location.hash=e})},$(function(){return $('a[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname)return e(this.hash),!1})}),$(document).on("DOMContentLoaded",function(){if(null!=location.hash&&""!==location.hash)return e(location.hash)})}.call(this);